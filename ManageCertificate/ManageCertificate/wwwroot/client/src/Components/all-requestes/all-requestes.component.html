<div *ngIf="isLoading" class="loading-container">
  <mat-progress-bar mode="indeterminate"></mat-progress-bar>
</div>

<div class="filters-wrapper">
  <div class="reset-button-container">
    <button mat-raised-button color="warn" (click)="resetFilters()">איפוס</button>
  </div>
 
  <div class="filters-container">
    <!-- סינון לפי סטטוס בקשה -->
    <mat-form-field appearance="fill" class="filter-item">
      <mat-label>סינון לפי סטטוס בקשה</mat-label>
      <mat-select [value]="isReset ? '' : RequestServiceService.selectedStatus" (selectionChange)="onSelectChange($event)">
        <mat-option value="">בחר סטטוס</mat-option>
        <mat-option *ngFor="let status of ListRefStatus" [value]="status.id">
          {{ status.name }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <!-- סינון לפי לשכת נישואין -->
    <mat-form-field appearance="fill" class="filter-item">
      <mat-label>סינון לפי לשכת נישואין</mat-label>
      <input
        matInput
        type="text"
        placeholder="הכנס לשכה"
        [value]="isReset ? '' : RequestServiceService.selectedCouncilId"
        (input)="onInputChangeCouncil($event)"
      />
    </mat-form-field>

    <!-- סינון לפי מספר בקשה -->
    <mat-form-field appearance="fill" class="filter-item">
      <mat-label>סינון לפי מספר בקשה</mat-label>
      <input
        matInput
        type="text"
        placeholder="הכנס מספר בקשה"
        [value]="isReset ? '' : RequestServiceService.selectedRequestId"
        (input)="onInputChangeNumReq($event)"
      />
    </mat-form-field>

    <!-- סינון לפי תאריך הזמנה -->
    <mat-form-field appearance="fill" class="filter-item">
      <mat-label>סינון לפי תאריך הזמנה</mat-label>
      <input
        matInput
        [matDatepicker]="picker"
        [value]="isReset ? '' : RequestServiceService.selectedDate"
        (dateChange)="onDateChange($event)"
      />
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker #picker></mat-datepicker>
    </mat-form-field>
  </div>
</div>
  <div>
    <!-- טבלת הבקשות -->
    <table mat-table [dataSource]="ListRequestes" matSort class="mat-elevation-z8">
      <ng-container matColumnDef="requestId">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> מספר בקשה </th>
        <td mat-cell *matCellDef="let element">{{ element.requestId }}</td>
      </ng-container>

      <ng-container matColumnDef="orderDate">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> תאריך בקשה </th>
        <td mat-cell *matCellDef="let element">{{ element.orderDate }}</td>
      </ng-container>

      <ng-container matColumnDef="deliveryMethod">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> שיטת איסוף</th>
        <td mat-cell *matCellDef="let element">{{ element.deliveryMethod }}</td>
      </ng-container>

      <ng-container matColumnDef="officeComment">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> הערת משרד </th>
        <td mat-cell *matCellDef="let element">{{ element?.officeComment || 'אין הערות' }}</td>
      </ng-container>

      <ng-container matColumnDef="councilId">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> מספר לשכה</th>
        <td mat-cell *matCellDef="let element">{{ element?.council?.name }}</td>
      </ng-container>

      <ng-container matColumnDef="requestStatus">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> סטטוס בקשה </th>
        <td mat-cell *matCellDef="let element">{{ element?.requestStatusNavigation?.name || 'סטטוס לא זמין' }}</td>
      </ng-container>

      <ng-container matColumnDef="Actions">
        <th mat-header-cell *matHeaderCellDef> הצגת פרטי הבקשה </th>
        <td mat-cell *matCellDef="let element">
          <div class="actions">
            <a [routerLink]="['/RequestDetails', element?.requestId ]"><mat-icon>info</mat-icon>Go to Request Details</a>
            
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>
 